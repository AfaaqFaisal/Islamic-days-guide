<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Days Guide</title>
    <style>
        :root {
            --color-bg-primary: #f8f9fa;
            --color-bg-secondary: #ffffff;
            --color-text-primary: #1a202c;
            --color-text-secondary: #4a5568;
            --color-accent: #2d6a4f;
            --color-accent-light: #40916c;
            --color-accent-dark: #1b4332;
            --color-border: #e2e8f0;
            --color-gold: #d4af37;
            --color-warning: #ed8936;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            --color-bg-primary: #1a1a1a;
            --color-bg-secondary: #2a2a2a;
            --color-text-primary: #f0f0f0;
            --color-text-secondary: #a0a0a0;
            --color-accent: #5fb884;
            --color-accent-light: #7ccb9a;
            --color-accent-dark: #4a9968;
            --color-border: #404040;
            --color-gold: #f0c674;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.4);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--color-bg-primary);
            color: var(--color-text-primary);
            line-height: 1.6;
            transition: background-color 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--color-accent-dark), var(--color-accent));
            color: white;
            padding: 30px 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .islamic-date {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .islamic-date-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .islamic-date-value {
            font-size: 18px;
            font-weight: 600;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            transition: background 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .notification-banner {
            background: var(--color-bg-secondary);
            border-left: 4px solid var(--color-accent);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }

        .notification-banner.today {
            border-left-color: var(--color-gold);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
        }

        .notification-banner.tomorrow {
            border-left-color: var(--color-warning);
        }

        .notification-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-text {
            color: var(--color-text-secondary);
            font-size: 15px;
        }

        .notification-settings {
            background: var(--color-bg-secondary);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-sm);
        }

        .notification-settings h3 {
            margin-bottom: 15px;
            color: var(--color-accent);
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .checkbox-label:hover {
            background: rgba(45, 106, 79, 0.05);
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--color-accent);
        }

        .search-box {
            margin-bottom: 30px;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 16px;
            background: var(--color-bg-secondary);
            color: var(--color-text-primary);
            transition: border-color 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--color-accent);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .calendar-card {
            background: var(--color-bg-secondary);
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .calendar-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--color-accent-light);
        }

        .calendar-card.major {
            border-left: 4px solid var(--color-gold);
        }

        .calendar-card.fasting {
            border-left: 4px solid var(--color-accent);
        }

        .calendar-card.night {
            border-left: 4px solid #805ad5;
        }

        .card-month {
            font-size: 13px;
            color: var(--color-text-secondary);
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--color-accent-dark);
        }

        .card-date {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: 12px;
        }

        .card-category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .category-major {
            background: rgba(212, 175, 55, 0.2);
            color: #b8860b;
        }

        .category-fasting {
            background: rgba(45, 106, 79, 0.2);
            color: var(--color-accent-dark);
        }

        .category-night {
            background: rgba(128, 90, 213, 0.2);
            color: #6b46c1;
        }

        .detail-view {
            background: var(--color-bg-secondary);
            padding: 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-md);
        }

        .detail-header {
            border-bottom: 2px solid var(--color-border);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }

        .detail-title {
            font-size: 32px;
            font-weight: 700;
            color: var(--color-accent-dark);
            margin-bottom: 10px;
        }

        .detail-date {
            font-size: 18px;
            color: var(--color-text-secondary);
            margin-bottom: 15px;
        }

        .detail-categories {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .back-button {
            background: var(--color-accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            transition: background 0.3s;
        }

        .back-button:hover {
            background: var(--color-accent-dark);
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-accent);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-content {
            font-size: 16px;
            line-height: 1.8;
            color: var(--color-text-primary);
        }

        .hadith-box {
            background: linear-gradient(135deg, rgba(45, 106, 79, 0.05), rgba(45, 106, 79, 0.1));
            border-left: 4px solid var(--color-accent);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Georgia', serif;
        }

        .hadith-text {
            font-size: 17px;
            line-height: 1.8;
            margin-bottom: 12px;
            font-style: italic;
        }

        .hadith-reference {
            font-size: 14px;
            color: var(--color-text-secondary);
            font-weight: 600;
            font-style: normal;
        }

        .checklist {
            list-style: none;
            padding: 0;
        }

        .checklist-item {
            padding: 15px;
            margin-bottom: 10px;
            background: var(--color-bg-primary);
            border-radius: 8px;
            display: flex;
            align-items: start;
            gap: 12px;
            transition: background 0.2s;
        }

        .checklist-item:hover {
            background: rgba(45, 106, 79, 0.05);
        }

        .checklist-icon {
            color: var(--color-accent);
            font-size: 20px;
            margin-top: 2px;
        }

        .checklist-text {
            flex: 1;
            font-size: 16px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: var(--color-bg-secondary);
            padding: 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
        }

        .dashboard-card-title {
            font-size: 16px;
            color: var(--color-text-secondary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .dashboard-card-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-accent-dark);
            margin-bottom: 5px;
        }

        .countdown {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .countdown-item {
            text-align: center;
            flex: 1;
        }

        .countdown-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--color-accent);
            display: block;
        }

        .countdown-label {
            font-size: 12px;
            color: var(--color-text-secondary);
            text-transform: uppercase;
        }

        .hidden {
            display: none;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--color-bg-secondary);
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: space-around;
            padding: 12px 0 calc(12px + env(safe-area-inset-bottom));
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
            color: var(--color-text-secondary);
            text-decoration: none;
            flex: 1;
            max-width: 120px;
        }

        .bottom-nav-item:hover {
            background: rgba(45, 106, 79, 0.1);
        }

        .bottom-nav-item.active {
            color: var(--color-accent);
            background: rgba(45, 106, 79, 0.15);
        }

        .bottom-nav-icon {
            font-size: 24px;
        }

        .bottom-nav-label {
            font-size: 11px;
            font-weight: 500;
        }

        .main-content {
            padding-bottom: 80px;
        }

        .warning-box {
            background: rgba(237, 131, 54, 0.1);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--color-warning);
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .header-top {
                flex-direction: column;
                align-items: flex-start;
            }

            .logo {
                font-size: 24px;
            }

            .detail-title {
                font-size: 24px;
            }

            .countdown {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-top">
                <div class="logo">
                    <span>üåô</span>
                    <span>Islamic Days Guide</span>
                </div>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">üåì</button>
            </div>
            <div class="islamic-date">
                <div class="islamic-date-label">Today's Islamic Date</div>
                <div class="islamic-date-value" id="currentHijriDate">Loading...</div>
            </div>
        </div>

        <div id="notificationBanner" class="notification-banner hidden">
            <div class="notification-title">
                <span id="notificationIcon"></span>
                <span id="notificationTitle"></span>
            </div>
            <div class="notification-text" id="notificationText"></div>
        </div>

        <div class="main-content">
            <div id="dashboardView">
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">üìÖ Today's Islamic Date</div>
                        <div class="dashboard-card-value" id="todayFullDate">Loading...</div>
                        <div style="margin-top: 10px; color: var(--color-text-secondary); font-size: 14px;" id="todayGregorian"></div>
                    </div>
                    <div class="dashboard-card">
                        <div class="dashboard-card-title">‚è∞ Next Special Day</div>
                        <div class="dashboard-card-value" id="nextSpecialDay">Calculating...</div>
                        <div class="countdown" id="countdown"></div>
                    </div>
                </div>
            </div>

            <div id="settingsView" class="hidden">
                <div class="notification-settings">
                    <h3>üì¨ Notification Preferences</h3>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="notifyDayBefore" checked>
                            <span>Show reminder one day before special days</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="notifyDayOf" checked>
                            <span>Show notification on special days</span>
                        </label>
                    </div>

                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--color-border);">
                        <h3 style="margin-bottom: 15px; color: var(--color-accent);">üîî Push Notifications</h3>
                        <p style="margin-bottom: 15px; color: var(--color-text-secondary); font-size: 14px;">
                            Enable push notifications to receive reminders even when the app is closed.
                        </p>
                        <button id="enablePushBtn" onclick="enablePushNotifications()" style="background: var(--color-accent); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; width: 100%; transition: background 0.3s;">
                            üîî Enable Push Notifications
                        </button>
                        <div id="pushStatus" style="margin-top: 12px; padding: 12px; border-radius: 6px; font-size: 14px; display: none;"></div>
                    </div>
                </div>
            </div>

            <div id="calendarView" class="hidden">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search for Islamic days, months, or events...">
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>

            <div id="detailView" class="hidden">
                <button class="back-button" onclick="showView('calendar')">‚Üê Back to Calendar</button>
                <div class="detail-view" id="detailContent"></div>
            </div>
        </div>

        <div class="bottom-nav">
            <div class="bottom-nav-item active" onclick="showView('dashboard')" id="navHome">
                <div class="bottom-nav-icon">üè†</div>
                <div class="bottom-nav-label">Home</div>
            </div>
            <div class="bottom-nav-item" onclick="showView('calendar')" id="navCalendar">
                <div class="bottom-nav-icon">üìÖ</div>
                <div class="bottom-nav-label">Calendar</div>
            </div>
            <div class="bottom-nav-item" onclick="showView('settings')" id="navSettings">
                <div class="bottom-nav-icon">‚öôÔ∏è</div>
                <div class="bottom-nav-label">Settings</div>
            </div>
        </div>
    </div>

    <script>
        const islamicDays = [
            {
                id: 1,
                name: "Islamic New Year",
                arabicName: "Ra's as-Sanah al-Hijriyyah",
                month: "Muharram",
                day: 1,
                gregorianDate: "July 7, 2024",
                category: "major",
                significance: "The first day of the Islamic calendar marks the Hijrah of Prophet Muhammad Ô∑∫ from Makkah to Madinah in 622 CE. This migration established the first Muslim community and marks the beginning of the Islamic era.",
                evidence: {
                    type: "hadith",
                    text: "The Prophet Ô∑∫ said: 'The best month for fasting after Ramadan is Muharram, and the best prayer after the obligatory prayers is prayer at night.'",
                    reference: "Sahih Muslim 1163"
                },
                actions: [
                    {
                        action: "Begin the year with sincere repentance",
                        time: "After Fajr",
                        benefit: "Fresh start with Allah"
                    },
                    {
                        action: "Increase voluntary fasting in Muharram",
                        time: "Throughout the month",
                        benefit: "Following authentic Sunnah"
                    },
                    {
                        action: "Reflect on the lessons of Hijrah",
                        time: "15-20 minutes",
                        benefit: "Understanding sacrifice and faith"
                    },
                    {
                        action: "Make du'a for a blessed year",
                        time: "Before sleeping",
                        benefit: "Seeking Allah's guidance"
                    }
                ]
            },
            {
                id: 2,
                name: "Day of Ashura",
                arabicName: "Yawm Ashura",
                month: "Muharram",
                day: 10,
                gregorianDate: "July 16, 2024",
                category: "fasting",
                significance: "On this day, Allah saved Prophet Musa (Moses) and the Children of Israel from Pharaoh. The Prophet Muhammad Ô∑∫ fasted on this day and commanded Muslims to fast, differentiating from other practices by fasting the 9th as well.",
                evidence: {
                    type: "hadith",
                    text: "Abu Qatadah reported: The Messenger of Allah Ô∑∫ was asked about fasting on the day of Ashura and he said, 'It expiates the sins of the previous year.'",
                    reference: "Sahih Muslim 1162"
                },
                actions: [
                    {
                        action: "Fast on the 10th of Muharram",
                        time: "Dawn to sunset",
                        benefit: "Expiation of previous year's sins"
                    },
                    {
                        action: "Fast on the 9th as well (recommended)",
                        time: "Dawn to sunset",
                        benefit: "Distinguishing from other practices"
                    },
                    {
                        action: "Increase Qur'an recitation",
                        time: "After each prayer",
                        benefit: "Drawing closer to Allah"
                    },
                    {
                        action: "Give charity",
                        time: "Anytime during the day",
                        benefit: "Helping those in need"
                    }
                ],
                misconceptions: "AVOID INNOVATION: There are NO authentic reports of the Prophet Ô∑∫ or Companions conducting special gatherings, reciting specific prayers with fixed numbers, or elaborate mourning rituals on this day. Stick to fasting and regular worship only."
            },
            {
                id: 3,
                name: "Mawlid an-Nabi",
                arabicName: "Mawlid an-Nabi",
                month: "Rabi' al-Awwal",
                day: 12,
                gregorianDate: "September 15, 2024",
                category: "major",
                significance: "This commemorates the birth of Prophet Muhammad Ô∑∫. While not celebrated during the Prophet's lifetime, many Muslims use this time to increase their love for him through studying his character and sending salawat.",
                evidence: {
                    type: "hadith",
                    text: "The Prophet Ô∑∫ was asked about fasting on Monday. He said, 'That is the day on which I was born and the day on which I received revelation.'",
                    reference: "Sahih Muslim 1162"
                },
                actions: [
                    {
                        action: "Study the Seerah (Prophet's biography)",
                        time: "30-60 minutes",
                        benefit: "Understanding his noble character"
                    },
                    {
                        action: "Increase sending salawat on the Prophet",
                        time: "Throughout the day",
                        benefit: "Earning Allah's blessings"
                    },
                    {
                        action: "Implement one Sunnah practice",
                        time: "Daily commitment",
                        benefit: "Following his example"
                    },
                    {
                        action: "Share his stories with children",
                        time: "Evening time",
                        benefit: "Teaching the next generation"
                    }
                ]
            },
            {
                id: 4,
                name: "15th of Sha'ban",
                arabicName: "Laylat al-Bara'ah",
                month: "Sha'ban",
                day: 15,
                gregorianDate: "February 13, 2025",
                category: "night",
                significance: "The 15th night of Sha'ban has narrations about special blessings, though scholars differ on authenticity. The mainstream Sunni approach is to engage in general worship without specific innovations. It's an excellent time for seeking forgiveness and preparing for Ramadan.",
                evidence: {
                    type: "note",
                    text: "While some hadiths mention this night, scholars like Al-Albani graded them as weak. However, general worship and seeking forgiveness are always encouraged in Islam.",
                    reference: "Scholarly consensus on weak narrations"
                },
                actions: [
                    {
                        action: "Make sincere istighfar (seek forgiveness)",
                        time: "Before sleeping - 10 minutes",
                        benefit: "The Prophet Ô∑∫ sought forgiveness regularly"
                    },
                    {
                        action: "Pray voluntary night prayer (Tahajjud)",
                        time: "Last third of night",
                        benefit: "Following authentic Sunnah"
                    },
                    {
                        action: "Increase Qur'an recitation",
                        time: "After Maghrib - 20 minutes",
                        benefit: "General worship encouraged anytime"
                    },
                    {
                        action: "Begin Ramadan spiritual preparation",
                        time: "Evening reflection",
                        benefit: "Setting intentions for blessed month"
                    }
                ],
                misconceptions: "IMPORTANT: There are NO authentic reports of the Prophet Ô∑∫ or Companions singling out this night for congregational worship, special prayers with fixed recitations, or elaborate celebrations. AVOID group gatherings with innovations. Stick to general worship you'd perform on any blessed night."
            },
            {
                id: 5,
                name: "Isra and Mi'raj",
                arabicName: "Al-Isra wal-Mi'raj",
                month: "Rajab",
                day: 27,
                gregorianDate: "January 27, 2025",
                category: "night",
                significance: "The Night Journey from Makkah to Jerusalem and the ascension through the heavens. During this journey, the five daily prayers were prescribed, demonstrating the importance of Salah and the Prophet's honored status with Allah.",
                evidence: {
                    type: "hadith",
                    text: "Anas ibn Malik reported: The Messenger of Allah Ô∑∫ said, 'I was brought al-Buraq... I rode upon it until I came to Bayt al-Maqdis (Jerusalem).'",
                    reference: "Sahih al-Bukhari 349"
                },
                actions: [
                    {
                        action: "Perform all five prayers on time",
                        time: "Throughout the day",
                        benefit: "Honoring the gift of Salah"
                    },
                    {
                        action: "Pray Tahajjud (night prayer)",
                        time: "Last third of night",
                        benefit: "Following the Prophet's practice"
                    },
                    {
                        action: "Read Surah Al-Isra (Chapter 17)",
                        time: "After Maghrib - 15 minutes",
                        benefit: "Reflecting on the journey"
                    },
                    {
                        action: "Make du'a for consistency in prayer",
                        time: "Before sleeping",
                        benefit: "Seeking Allah's help"
                    }
                ]
            },
            {
                id: 6,
                name: "First Day of Ramadan",
                arabicName: "Awwal Ramadan",
                month: "Ramadan",
                day: 1,
                gregorianDate: "March 1, 2025",
                category: "major",
                significance: "The beginning of the blessed month of fasting, Qur'an revelation, and spiritual elevation. This is when the gates of Paradise are opened, gates of Hell closed, and devils are chained according to authentic hadith.",
                evidence: {
                    type: "hadith",
                    text: "The Prophet Ô∑∫ said, 'Whoever fasts Ramadan out of faith and seeking reward, his previous sins will be forgiven.'",
                    reference: "Sahih al-Bukhari 38, Sahih Muslim 760"
                },
                actions: [
                    {
                        action: "Fast from dawn to sunset with intention",
                        time: "Full day",
                        benefit: "Obligatory act of worship"
                    },
                    {
                        action: "Break fast with dates and water",
                        time: "At Maghrib",
                        benefit: "Following the Sunnah"
                    },
                    {
                        action: "Pray Taraweeh at night",
                        time: "After Isha - 30-45 minutes",
                        benefit: "Earning immense reward"
                    },
                    {
                        action: "Set a Qur'an recitation goal",
                        time: "Throughout Ramadan",
                        benefit: "The month of Qur'an"
                    }
                ]
            },
            {
                id: 7,
                name: "Laylatul Qadr",
                arabicName: "Laylat al-Qadr",
                month: "Ramadan",
                day: "27 (seek in last 10 odd nights)",
                gregorianDate: "March 27, 2025",
                category: "night",
                significance: "The Night of Power is better than a thousand months. The Qur'an was first revealed on this night. It occurs in the last ten nights of Ramadan, particularly on odd nights (21st, 23rd, 25th, 27th, 29th).",
                evidence: {
                    type: "hadith",
                    text: "Abu Hurairah reported: The Prophet Ô∑∫ said, 'Whoever stands (in prayer) during Laylatul Qadr with faith and seeking reward, his previous sins will be forgiven.'",
                    reference: "Sahih al-Bukhari 1901, Sahih Muslim 760"
                },
                actions: [
                    {
                        action: "Perform lengthy Tahajjud prayers",
                        time: "Throughout the night",
                        benefit: "The best night of the year"
                    },
                    {
                        action: "Recite: Allahumma innaka 'afuwwun...",
                        time: "Frequently during the night",
                        benefit: "Du'a taught by the Prophet Ô∑∫"
                    },
                    {
                        action: "Recite Qur'an abundantly",
                        time: "Between prayers",
                        benefit: "The night of Qur'an revelation"
                    },
                    {
                        action: "Make extensive du'a for yourself and Ummah",
                        time: "Last third of night",
                        benefit: "Du'as are highly accepted"
                    }
                ]
            },
            {
                id: 8,
                name: "Eid al-Fitr",
                arabicName: "Eid al-Fitr",
                month: "Shawwal",
                day: 1,
                gregorianDate: "March 31, 2025",
                category: "major",
                significance: "The Festival of Breaking the Fast celebrates the completion of Ramadan. It's a day of gratitude to Allah, communal prayer, and celebration. Zakat al-Fitr must be given before the Eid prayer.",
                evidence: {
                    type: "hadith",
                    text: "Ibn Abbas reported: The Messenger of Allah Ô∑∫ enjoined Zakat al-Fitr as a purification for the fasting person from idle talk and obscenities, and as food for the needy.",
                    reference: "Sunan Abu Dawud 1609, graded Hasan"
                },
                actions: [
                    {
                        action: "Pay Zakat al-Fitr before prayer",
                        time: "Before Eid prayer",
                        benefit: "Obligatory purification"
                    },
                    {
                        action: "Take ghusl and wear best clothes",
                        time: "Morning before prayer",
                        benefit: "Following the Sunnah"
                    },
                    {
                        action: "Eat dates before going to prayer",
                        time: "Before leaving home",
                        benefit: "Sunnah of the Prophet Ô∑∫"
                    },
                    {
                        action: "Attend Eid prayer in congregation",
                        time: "Mid-morning",
                        benefit: "Community celebration"
                    }
                ]
            },
            {
                id: 9,
                name: "Day of Arafah",
                arabicName: "Yawm Arafah",
                month: "Dhul Hijjah",
                day: 9,
                gregorianDate: "June 6, 2025",
                category: "fasting",
                significance: "The greatest day of the year. Pilgrims stand at Arafah (the pinnacle of Hajj). For non-pilgrims, fasting expiates sins of two years. It's a day when Allah frees countless people from the Fire.",
                evidence: {
                    type: "hadith",
                    text: "Abu Qatadah reported: The Messenger of Allah Ô∑∫ was asked about fasting on the day of Arafah and he said, 'It expiates the sins of the previous year and the coming year.'",
                    reference: "Sahih Muslim 1162"
                },
                actions: [
                    {
                        action: "Fast on the Day of Arafah (if not performing Hajj)",
                        time: "Dawn to sunset",
                        benefit: "Expiation of two years' sins"
                    },
                    {
                        action: "Make abundant du'a throughout the day",
                        time: "Especially afternoon",
                        benefit: "Du'as are highly accepted"
                    },
                    {
                        action: "Recite Tahlil and Takbir frequently",
                        time: "Throughout the day",
                        benefit: "Following the Sunnah"
                    },
                    {
                        action: "Give generous charity",
                        time: "Anytime during the day",
                        benefit: "Multiplied reward"
                    }
                ]
            },
            {
                id: 10,
                name: "Eid al-Adha",
                arabicName: "Eid al-Adha",
                month: "Dhul Hijjah",
                day: 10,
                gregorianDate: "June 7, 2025",
                category: "major",
                significance: "The Festival of Sacrifice commemorates Prophet Ibrahim's willingness to sacrifice his son. It marks the end of Hajj. Those who can afford it sacrifice an animal, distributing meat to family, friends, and the poor.",
                evidence: {
                    type: "hadith",
                    text: "Zaid ibn Arqam reported: The Companions said, 'O Messenger of Allah, what is al-Adha?' He said, 'It is the Sunnah of your father Ibrahim.' They said, 'What reward do we get?' He said, 'For every hair, you get a reward.'",
                    reference: "Sunan Ibn Majah 3127, graded Hasan"
                },
                actions: [
                    {
                        action: "Perform Eid prayer in congregation",
                        time: "Mid-morning",
                        benefit: "Community worship"
                    },
                    {
                        action: "Perform Udhiyah (sacrifice) if able",
                        time: "After Eid prayer",
                        benefit: "Following Ibrahim's example"
                    },
                    {
                        action: "Distribute meat: 1/3 family, 1/3 friends, 1/3 poor",
                        time: "Throughout the day",
                        benefit: "Sharing blessings"
                    },
                    {
                        action: "Make Takbir from Fajr onwards",
                        time: "After each prayer",
                        benefit: "Days of Tashriq"
                    }
                ]
            }
        ];

        let currentView = 'dashboard';
        let hijriDate = null;

        function init() {
            loadTheme();
            calculateHijriDate();
            renderCalendar();
            updateDashboard();
            checkNotifications();
            
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            document.getElementById('notifyDayBefore').addEventListener('change', checkNotifications);
            document.getElementById('notifyDayOf').addEventListener('change', checkNotifications);
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            sessionStorage.setItem('theme', next);
        }

        function loadTheme() {
            const saved = sessionStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', saved);
        }

        function kuwaiticalendar(adjust) {
            const today = new Date();
            if (adjust) today.setDate(today.getDate() + adjust);

            let day = today.getDate();
            let month = today.getMonth() + 1;
            let year = today.getFullYear();

            if (month < 3) {
                year -= 1;
                month += 12;
            }

            const a = Math.floor(year / 100);
            let b = 2 - a + Math.floor(a / 4);
            if (year < 1583) b = 0;

            const jd = Math.floor(365.25 * (year + 4716)) + Math.floor(30.6001 * (month + 1)) + day + b - 1524;
            const iyear = 10631.0 / 30.0;
            const epochastro = 1948084;
            const shift1 = 8.01 / 60.0;

            let z = jd - epochastro;
            const cyc = Math.floor(z / 10631.0);
            z = z - 10631.0 * cyc;
            const j = Math.floor((z - shift1) / iyear);
            const iy = 30 * cyc + j;
            z = z - Math.floor(j * iyear + shift1);
            let im = Math.floor((z + 28.5001) / 29.5);
            if (im === 13) im = 12;
            const id = z - Math.floor(29.5001 * im - 29);

            const monthNames = [
                'Muharram', 'Safar', "Rabi' al-Awwal", "Rabi' al-Thani",
                'Jumada al-Awwal', 'Jumada al-Thani', 'Rajab', "Sha'ban",
                'Ramadan', 'Shawwal', "Dhul Qi'dah", 'Dhul Hijjah'
            ];

            return {
                day: Math.floor(id),
                month: monthNames[im - 1],
                monthIndex: im - 1,
                year: iy
            };
        }

        function calculateHijriDate() {
            hijriDate = kuwaiticalendar(0);
            const hijriString = `${hijriDate.day} ${hijriDate.month} ${hijriDate.year} AH`;
            document.getElementById('currentHijriDate').textContent = hijriString;
            document.getElementById('todayFullDate').textContent = hijriString;
            
            const today = new Date();
            const gregorianDate = today.toLocaleDateString('en-GB', { 
                day: 'numeric', month: 'long', year: 'numeric' 
            });
            document.getElementById('todayGregorian').textContent = gregorianDate;
        }

        function checkNotifications() {
            if (!hijriDate) return;

            const notifyBefore = document.getElementById('notifyDayBefore').checked;
            const notifyDayOf = document.getElementById('notifyDayOf').checked;
            let found = false;

            if (notifyDayOf) {
                const today = islamicDays.find(day => 
                    typeof day.day === 'number' && 
                    day.month === hijriDate.month && 
                    day.day === hijriDate.day
                );

                if (today) {
                    showBanner(today.name, `Today is ${today.name}. ${today.significance.substring(0, 100)}...`, '‚ú®', 'today');
                    found = true;
                }
            }

            if (!found && notifyBefore) {
                const tomorrow = islamicDays.find(day => 
                    typeof day.day === 'number' && 
                    day.month === hijriDate.month && 
                    day.day === hijriDate.day + 1
                );

                if (tomorrow) {
                    showBanner(`Tomorrow: ${tomorrow.name}`, `Prepare for ${tomorrow.name}. ${tomorrow.significance.substring(0, 80)}...`, '‚è∞', 'tomorrow');
                    found = true;
                }
            }

            if (!found) {
                document.getElementById('notificationBanner').classList.add('hidden');
            }
        }

        function showBanner(title, text, icon, type) {
            const banner = document.getElementById('notificationBanner');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationText').textContent = text;
            document.getElementById('notificationIcon').textContent = icon;
            banner.className = `notification-banner ${type}`;
            banner.classList.remove('hidden');
        }

        function updateDashboard() {
            if (!hijriDate) return;

            const monthNames = [
                'Muharram', 'Safar', "Rabi' al-Awwal", "Rabi' al-Thani",
                'Jumada al-Awwal', 'Jumada al-Thani', 'Rajab', "Sha'ban",
                'Ramadan', 'Shawwal', "Dhul Qi'dah", 'Dhul Hijjah'
            ];

            let next = null;
            let minDiff = Infinity;

            islamicDays.forEach(day => {
                if (typeof day.day === 'number') {
                    const dayMonthIndex = monthNames.indexOf(day.month);
                    const currentMonthIndex = hijriDate.monthIndex;
                    
                    let diff = (dayMonthIndex - currentMonthIndex) * 30 + (day.day - hijriDate.day);
                    if (diff <= 0) diff += 354;
                    
                    if (diff > 0 && diff < minDiff) {
                        minDiff = diff;
                        next = day;
                    }
                }
            });

            if (next) {
                document.getElementById('nextSpecialDay').textContent = next.name;
                document.getElementById('countdown').innerHTML = `
                    <div class="countdown-item">
                        <span class="countdown-value">${minDiff}</span>
                        <span class="countdown-label">Days</span>
                    </div>
                `;
            } else {
                document.getElementById('nextSpecialDay').textContent = 'No upcoming days';
                document.getElementById('countdown').innerHTML = '';
            }
        }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';

            islamicDays.forEach(day => {
                const card = document.createElement('div');
                card.className = `calendar-card ${day.category}`;
                card.onclick = () => showDetail(day.id);

                const dateText = typeof day.day === 'number' ? `${day.day} ${day.month}` : day.day;
                const categoryLabel = {
                    'major': 'Major Day',
                    'fasting': 'Fasting',
                    'night': 'Special Night'
                };

                card.innerHTML = `
                    <div class="card-month">${day.month}</div>
                    <div class="card-title">${day.name}</div>
                    <div class="card-date">${dateText}</div>
                    <div class="card-date" style="color: var(--color-accent); font-weight: 500; margin-top: 4px;">${day.gregorianDate || 'Date varies'}</div>
                    <span class="card-category category-${day.category}">${categoryLabel[day.category]}</span>
                `;

                grid.appendChild(card);
            });
        }

        function handleSearch(e) {
            const query = e.target.value.toLowerCase();
            document.querySelectorAll('.calendar-card').forEach(card => {
                const text = card.textContent.toLowerCase();
                card.style.display = text.includes(query) ? 'block' : 'none';
            });
        }

        function showDetail(id) {
            const day = islamicDays.find(d => d.id === id);
            if (!day) return;

            const categoryLabel = {
                'major': 'Major Day',
                'fasting': 'Fasting Day',
                'night': 'Special Night'
            };

            let html = `
                <div class="detail-header">
                    <div class="detail-title">${day.name}</div>
                    <div class="detail-date">${day.arabicName} ‚Ä¢ ${typeof day.day === 'number' ? day.day : ''} ${day.month}</div>
                    <div class="detail-date" style="color: var(--color-accent); margin-top: 8px;">Approximate Date: ${day.gregorianDate || 'Date varies yearly'}</div>
                    <div class="detail-categories">
                        <span class="card-category category-${day.category}">${categoryLabel[day.category]}</span>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">üìñ Significance</div>
                    <div class="section-content">${day.significance}</div>
                </div>

                <div class="section">
                    <div class="section-title">üìö ${day.evidence.type === 'hadith' ? 'Authentic Evidence' : 'Important Note'}</div>
                    <div class="hadith-box">
                        <div class="hadith-text">"${day.evidence.text}"</div>
                        <div class="hadith-reference">‚Äî ${day.evidence.reference}</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">‚úÖ Recommended Actions</div>
                    <ul class="checklist">
            `;

            day.actions.forEach(item => {
                html += `
                    <li class="checklist-item">
                        <span class="checklist-icon">‚òê</span>
                        <span class="checklist-text">
                            <strong>${item.action}</strong><br>
                            <span style="color: var(--color-text-secondary); font-size: 14px;">
                                ${item.time} ‚Ä¢ ${item.benefit}
                            </span>
                        </span>
                    </li>
                `;
            });

            html += `</ul></div>`;

            if (day.misconceptions) {
                html += `
                    <div class="section">
                        <div class="section-title">‚ö†Ô∏è Important: Avoiding Innovations</div>
                        <div class="warning-box">
                            <strong style="color: var(--color-warning);">Common Misconceptions:</strong><br>
                            ${day.misconceptions}
                        </div>
                    </div>
                `;
            }

            document.getElementById('detailContent').innerHTML = html;
            showView('detail');
        }

        function showView(view) {
            currentView = view;

            document.getElementById('dashboardView').classList.toggle('hidden', view !== 'dashboard');
            document.getElementById('calendarView').classList.toggle('hidden', view !== 'calendar');
            document.getElementById('detailView').classList.toggle('hidden', view !== 'detail');
            document.getElementById('settingsView').classList.toggle('hidden', view !== 'settings');

            document.getElementById('navHome').classList.toggle('active', view === 'dashboard');
            document.getElementById('navCalendar').classList.toggle('active', view === 'calendar' || view === 'detail');
            document.getElementById('navSettings').classList.toggle('active', view === 'settings');
        }

        function enablePushNotifications() {
            const statusEl = document.getElementById('pushStatus');
            const btn = document.getElementById('enablePushBtn');

            if (!('Notification' in window)) {
                statusEl.textContent = '‚ùå Your browser does not support notifications.';
                statusEl.style.display = 'block';
                statusEl.style.background = 'rgba(237, 131, 54, 0.2)';
                statusEl.style.color = 'var(--color-warning)';
                return;
            }

            if (Notification.permission === 'granted') {
                statusEl.textContent = '‚úÖ Push notifications are already enabled!';
                statusEl.style.display = 'block';
                statusEl.style.background = 'rgba(45, 106, 79, 0.2)';
                statusEl.style.color = 'var(--color-accent)';
                btn.textContent = '‚úì Notifications Enabled';
                btn.disabled = true;
                btn.style.opacity = '0.6';
                return;
            }

            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    statusEl.textContent = '‚úÖ Push notifications enabled successfully!';
                    statusEl.style.display = 'block';
                    statusEl.style.background = 'rgba(45, 106, 79, 0.2)';
                    statusEl.style.color = 'var(--color-accent)';
                    btn.textContent = '‚úì Notifications Enabled';
                    btn.disabled = true;
                    btn.style.opacity = '0.6';

                    new Notification('Islamic Days Guide üåô', {
                        body: 'Notifications enabled! You\'ll receive reminders for special Islamic days.',
                        icon: 'üåô'
                    });
                } else {
                    statusEl.textContent = '‚ùå Permission denied. Enable notifications in your browser settings.';
                    statusEl.style.display = 'block';
                    statusEl.style.background = 'rgba(237, 131, 54, 0.2)';
                    statusEl.style.color = 'var(--color-warning)';
                }
            });
        }

        init();
    </script>
</body>
</html>
